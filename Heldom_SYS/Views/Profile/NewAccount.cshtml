@* stylesheet *@
<link rel="stylesheet" href="~/css/Profile/NewAccount.css" />
@* https://localhost:7142/Profile/NewAccount *@

<div class="main_wrap border-radius box-shadow">
	<div class="top_area">
		<h4 class="bold">編輯員工資料</h4>
		<div class="form-check form-switch switch_wrap">
			<label class="form-check-label" for="flexSwitchCheckDefault" id="switch_txt">啟用中</label>
			<input class="form-check-input" type="checkbox" id="flexSwitchCheckDefault" checked>
		</div>
	</div>
	<div class="middle_area">
		<div class="middle_area_left">
			<div class="photo_wrap">
				<p class="color-gray-dark bold p_width">員工照片</p>
				<div class="photo-box" id="photoBox">
					<div class="upload-area obj-center">
						<i class="fas fa-plus obj-center"></i>
					</div>
				</div>
			</div>
			<div class="input_wrap">
				<p class="color-gray-dark bold p_width">員工姓名</p>
				<input value="姓名" class="form-control" />
			</div>
			<div class="input_wrap">
				<p class="color-gray-dark bold p_width">身分證編號</p>
				<input value="A123456789" class="form-control" />
			</div>
			<div class="input_wrap">
				<p class="color-gray-dark bold p_width">聯絡電話</p>
				<input value="0919-123456" class="form-control" />
			</div>
			<div class="input_wrap">
				<p class="color-gray-dark bold p_width">緊急聯絡人</p>
				<input value="聯絡人" class="form-control" />
			</div>
			<div class="input_wrap">
				<p class="color-gray-dark bold p_width">到職日</p>
				<input type="date" value="" class="form-control" />
			</div>
		</div>
		<div class="middle_area_right">
			<div class="input_wrap">
				<p class="color-gray-dark bold p_width">員工編號</p>
				<input value="ABC-123456" class="form-control" disabled />
			</div>
			<div class="input_wrap">
				<p class="color-gray-dark bold p_width">帳號權限</p>
				<select class="form-select">
					<option selected>限制權限</option>
					<option>所有權限</option>
					<option>管理權限</option>
					<option>一般權限</option>
				</select>
			</div>
			<div class="input_wrap">
				<p class="color-gray-dark bold p_width">部門</p>
				<select class="form-select">
					<option selected>管理部</option>
				</select>
			</div>
			<div class="input_wrap">
				<p class="color-gray-dark bold p_width">職稱</p>
				<select class="form-select">
					<option>工地主任</option>
					<option selected>一般職員</option>
				</select>
			</div>
			<div class="input_wrap">
				<p class="color-gray-dark bold p_width">出生日期</p>
				<input type="date" value="" class="form-control" />
			</div>
			<div class="input_wrap">
				<p class="color-gray-dark bold p_width">地址</p>
				<input value="台中市台中市台中市台中市台中市" class="form-control" />
			</div>
			<div class="input_wrap">
				<p class="color-gray-dark bold p_width">緊急電話</p>
				<input value="0919-123456" class="form-control" />
			</div>
			<div class="input_wrap">
				<p class="color-gray-dark bold p_width">離職日</p>
				<input type="date" value="" class="form-control" />
			</div>
		</div>
	</div>
	<div class="end_area obj-center">
		<button type="button" class="btn btn-outline" id="cancel"><p class="color-blue">取消</p></button>
		<button type="button" class="btn btn-primary" id="save_btn"><p>儲存</p></button>
	</div>
</div>

<!-- 文件上傳輸入框 -->
<input type="file" class="form-control d-none" id="fileAdd" accept="image">

<!-- 儲存按鈕 Modal -->
<div id="clockPopup" class="modal clock-popup-wrap">
	<div class="modal-dialog clock-popup-content">
		<div class="modal-content">
			<div class="modal-header clock-top obj-vertical-center">
				<h5 class="modal-title color-gray-dark bold">提醒已離職人員</h5>
				<div class="clock-close obj-center"><i class="fas fa-times"></i></div>
			</div>
			<div class="modal-body clock-area">
				<h1 id="timeClock" class="color-gray-medium bold">提交後將關閉啟用狀態</h1>
				<h4 class="color-gray-dark bold">是否確認提交?</h4>
			</div>
			<div class="modal-footer clock-check">
				<button class="clock-button_cancel obj-center">
					<p class="bold color-blue">否</p>
				</button>
				<button class="clock-button obj-center">
					<p class="bold color-white">是</p>
				</button>
			</div>
		</div>
	</div>
</div>



<script>
	// 是否啟用 文字控制
	const switchInput = document.getElementById("flexSwitchCheckDefault");
	const switchLabel = document.getElementById("switch_txt");

	switchInput.addEventListener("change", function() {
		if (this.checked) {
			switchLabel.textContent = "啟用中";
		} else {
			switchLabel.textContent = "已關閉";
		}
	});

	//打卡視窗控制
	$("#save_btn").click(function(){
		$("#clockPopup").fadeIn();
	});

	$(".clock-close").click(function(){
		$("#clockPopup").fadeOut();
	});

	// 點擊背景區域關閉彈窗
	$("#clockPopup").click(function(event) {
		if(event.target === this) {
			$(this).fadeOut();
		}
	});

	// 照片上傳功能
	$(document).ready(function() {
		let currentPhoto = null;

		// 點擊上傳區域觸發文件選擇
		$("#photoBox").on("click", function() {
			$("#fileAdd").click();
		});

		// 監聽文件上傳
		$("#fileAdd").on("change", function(event) {
			let file = event.target.files[0];

			if (file && file.type.startsWith("image/")) {
				let reader = new FileReader();
				reader.onload = function(e) {
					let imgStr = e.target.result;
					currentPhoto = imgStr;

					// 更新預覽圖
					$(".upload-area").remove();
					$("#photoBox").html(`
						<img src="${imgStr}" class="preview-img" style="width: 100%; height: 100%; object-fit: cover; border-radius: 10px;">
					`);
				};
				reader.readAsDataURL(file);
			} else {
				console.log("請選擇圖片檔案");
			}
		});
	});

	$('#cancel').click(function(){
		location.href = "/Profile/Account";
	})
</script>